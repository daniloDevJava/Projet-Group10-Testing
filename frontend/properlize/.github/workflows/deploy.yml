deploy:
  name: Deploy to Production
  needs: test
  runs-on: ubuntu-latest
  if: github.ref == 'refs/heads/main'
  
  steps:
  - uses: actions/checkout@v4

  - name: Setup Node.js
    uses: actions/setup-node@v3
    with:
      node-version: '18'

  - name: Install dependencies
    run: npm ci

  - name: Build project
    run: npm run build

  - name: Deploy to Vercel
    uses: amondnet/vercel-action@v30
    with:
      vercel-token: ${{ secrets.VERCEL_TOKEN }}
      vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
      vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
      working-directory: . # adapte si ton code est dans un sous-dossier
      vercel-args: '--prod'
    env:
      VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
